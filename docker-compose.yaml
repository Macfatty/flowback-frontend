services:
  flowback-frontend:
    # Build configuration using the Dockerfile in the current directory
    build:
      context: .
      args:
        # Passes the API URL from your .env file to the Docker build process
        - PUBLIC_API_URL=${PUBLIC_API_URL:-/api}
    
    container_name: flowback-frontend
    restart: unless-stopped
    
    # By default, we run the production build (from the multi-stage Dockerfile)
    # The Dockerfile CMD is used here, so we don't need a custom 'command' line
    # unless we want to override it.
    
    ports:
      # Maps the host port to the container port (defaulting to 3000)
      - "${PORT:-3000}:${PORT:-3000}"
    
    env_file:
      - .env

    volumes:
      # Sync the entire project directory to /app for development
      - ./:/app
      # Anonymous volume for node_modules: 
      # This prevents your laptop's local node_modules from overwriting 
      # the correct Linux-based packages inside the container.
      - /app/node_modules

    # Network settings for the internal gateway/proxy
    networks:
      - flowback-network

networks:
  flowback-network:
    external: true
